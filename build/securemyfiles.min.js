!function(a){!function(a){a.sEncrypt={Encryptors:{}}}(this),function(a){function b(a,b){if(a.length>b)throw"String is too large";for(var c=new Array(b),d=a.length-1,e=b-1;d>=0;d--,e--)c[e]=a.charCodeAt(d);for(;e>=0;)c[e--]=0;return c}function c(a){for(var b="",c=0;c<a.byteLength;c++)0!==a[c]&&(b+=String.fromCharCode(a[c]));return b}function d(a){var b,c,d,e=[];a||(a=[]);for(var f=0;16>f;f++)for(b=a.length>1?a.splice(f,1):[10*Math.random(),10*Math.random()],c=new Date,d=b.length?b[0]*Math.random()/10:(10*Math.random()+100*Math.random()+1e3*Math.random())/100,e[f]=parseInt(d*c.getMilliseconds()/10);e[f]>255;)e[f]-=255;return e}function e(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}var f=function(f){function g(){if(e(f,p),!f.readBlock)throw"The 'readBlock' parameter was not present in the options";if(!f.saveBlock)throw"The 'saveBlock' parameter was not present in the options";if(!f.finishHandler)throw"The 'finishHandler' parameter was not present in the options";if(!f.errorHandler)throw"The 'errorHandler' parameter was not present in the options"}function h(a,c){if(!a)throw"The parameter 'key' was not present";var e=d(c);f.saveBlock(e),a=b(a,f.keyLength/8),l=new f.algorithm(a,e,f.keyLength),f.readBlock(n,i)}function i(a){f.progressHandler&&f.progressHandler(a.byteLength),a=l.encrypt(a),f.saveBlock(a),f.readBlock(n,i)||(f.saveBlock(b(l.getChecksum(),16),!0),f.finishHandler())}function j(a){var d;if(!a)throw"The parameter 'key' was not present";f.readBlock(32,function(e){m=c(e.slice(0,16)),d=e.slice(16),a=b(a,f.keyLength/8),l=new f.algorithm(a,d,f.keyLength),f.readBlock(n,k)})}function k(a){if(f.progressHandler&&f.progressHandler(a.byteLength),a=l.decrypt(a),f.saveBlock(a),!f.readBlock(n,k))if(m===l.getChecksum()){var b=a[a.length-1];f.finishHandler(b)}else f.errorHandler(1)}var l,m,n=16e4,o={encrypt:h,decrypt:j},p={algorithm:a.sEncrypt.Encryptors.AESCBC,keyLength:256};return g(),o};a.sEncrypt.Encryptor=f}(this),function(a){var b=function(a,b,c){function d(b){for(var c,d,e,f,i,j=0,k=[];j<b.byteLength;){for(c=j+16,c>b.byteLength&&(c=b.byteLength),f=[],e=0,d=j;c>d;e++,d++)f[e]=b[d];if(16>e)for(i=16-e;16>e;)f[e++]=i;for(z^=g(f),h(f,x),p(f,a),x=f.slice(0),e=0,d=k.length;16>e;e++,d++)k[d]=f[e];j+=16}return k}function e(b){for(var c,d,e,f,i,j=0,k=[];j<b.byteLength;){for(e=j+16,e>b.byteLength&&(e=b.byteLength),f=[],c=0,d=j;e>d;c++,d++)f[c]=b[d];for(i=f.slice(0),q(f,a),h(f,y),z^=g(f),y=i,c=0,d=k.length;16>c;c++,d++)k[d]=f[c];j+=16}return k}function f(){return z.toString()}function g(a){for(var b=0,c=a.length,d=0;c>d;d++)b=31*b+a[d];return b}function h(a,b){for(var c=0;16>c;c++)a[c]=a[c]^b[c]}function i(a,b){for(var c=0;16>c;c++)a[c]^=b[c]}function j(a,b){for(var c=0;16>c;c++)a[c]=b[a[c]]}function k(a,b){for(var c=a.slice(0),d=0;16>d;d++)a[d]=c[b[d]]}function l(a){for(var b=0;16>b;b+=4){var c=a[b+0],d=a[b+1],e=a[b+2],f=a[b+3],g=c^d^e^f;a[b+0]^=g^v[c^d],a[b+1]^=g^v[d^e],a[b+2]^=g^v[e^f],a[b+3]^=g^v[f^c]}}function m(a){for(var b=0;16>b;b+=4){var c=a[b+0],d=a[b+1],e=a[b+2],f=a[b+3],g=c^d^e^f,h=v[g],i=v[v[h^c^e]]^g,j=v[v[h^d^f]]^g;a[b+0]^=i^v[c^d],a[b+1]^=j^v[d^e],a[b+2]^=i^v[e^f],a[b+3]^=j^v[f^c]}}function n(){r=new Array(99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22),s=new Array(0,5,10,15,4,9,14,3,8,13,2,7,12,1,6,11),t=new Array(256);for(var a=0;256>a;a++)t[r[a]]=a;u=new Array(16);for(var b=0;16>b;b++)u[s[b]]=b;v=new Array(256);for(var c=0;128>c;c++)v[c]=c<<1,v[128+c]=c<<1^27}function o(a){var b,c=a.length,d=1;switch(c){case 16:b=176;break;case 24:b=208;break;case 32:b=240;break;default:throw"Key error: Only key lengths of 16, 24 or 32 bytes allowed!"}for(var e=c;b>e;e+=4){var f=a.slice(e-4,e);e%c===0?(f=new Array(r[f[1]]^d,r[f[2]],r[f[3]],r[f[0]]),(d<<=1)>=256&&(d^=283)):c>24&&e%c==16&&(f=new Array(r[f[0]],r[f[1]],r[f[2]],r[f[3]]));for(var g=0;4>g;g++)a[e+g]=a[e+g-c]^f[g]}}function p(a,b){var c=b.length;i(a,b.slice(0,16));for(var d=16;c-16>d;d+=16)j(a,r),k(a,s),l(a),i(a,b.slice(d,d+16));j(a,r),k(a,s),i(a,b.slice(d,c))}function q(a,b){var c=b.length;i(a,b.slice(c-16,c)),k(a,u),j(a,t);for(var d=c-32;d>=16;d-=16)i(a,b.slice(d,d+16)),m(a),k(a,u),j(a,t);i(a,b.slice(0,16))}var a,r,s,t,u,v,w={chunkSize:16e4,encrypt:d,decrypt:e,getChecksum:f},x=b,y=b,z=0;return n(),o(a),w};a.sEncrypt.Encryptors.AESCBC=b}(this);var b=function(a){var b=0,d=new FileReader,e=a.size,f=a.name,g=[],h=e-32,i="undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator),j="undefined"!=typeof webkitRequestFileSystem&&function(a,b){webkitRequestFileSystem(TEMPORARY,h,function(c){c.root.getDirectory("SecureMyFiles",{create:!0},function(c){var d=function(){c.getFile(b,{create:!0,exclusive:!1},function(b){b.createWriter(function(c){c.onwriteend=function(a){window.location.href=b.toURL()},c.write(a)})})};c.getFile(b,{create:!1},function(a){a.remove(d)},function(){d()})})})},k=function(a,b){var c=URL.createObjectURL(a),d=document.createElement("a");d.style="display: none",document.body.appendChild(d),d.href=c,d.download=b,d.click(),setTimeout(function(){URL.revokeObjectURL(c)},0)};this.readChunk=function(c,f){if(b>=e)return!1;var g=c;return b+c>e&&(g=e-b),d.onload=function(a){if(2===d.readyState){var b=new Uint8Array(d.result);"function"==typeof f&&setTimeout(function(){f(b)},5)}},d.readAsArrayBuffer(a.slice(b,b+g)),b+=g,!0},this.store=function(a,b,c){g=b?a.concat(g):g.concat(a),"function"==typeof c&&c()},this.getLength=function(){return e},this.getData=function(a){return c.toTypedArray(g,h-a)},this.saveToDisk=function(a){var b=i||j||k,d=new Blob([c.toTypedArray(g,h-a)],{type:"application/octet-stream"});f=h?f.replace(".smfw",""):f.concat(".smfw"),b(d,f)}},c={};c.toTypedArray=function(a,b){for(var c=b?Math.min(a.length,b):a.length,d=new Uint8Array(c),e=c-1;e>=0;e--)d[e]=a[e];return d},c.stringToByteArray=function(a,b){if(a.length>b)throw"String is too large";for(var c=new Array(b),d=a.length-1,e=b-1;d>=0;d--,e--)c[e]=a.charCodeAt(d);for(;e>=0;)c[e--]=0;return c},c.byteArrayToString=function(a){for(var b="",c=0;c<a.byteLength;c++)0!==a[c]&&(b+=String.fromCharCode(a[c]));return b},c.RandomGenerator=function(){var a=!1,b=[],c=function(){"undefined"!=typeof document&&(!a&&b.length<=102400?(document.addEventListener("mousemove",d),a=!0):a&&b.length>102400&&(document.removeEventListener("mousemove",d),a=!1))},d=function(a){b.push(a.screenX),b.push(a.screenY),c()};this.generate=function(){for(var a,d,e,f=[],g=0;16>g;g++)for(a=b.length>1?b.splice(g,2):[10*Math.random(),10*Math.random()],d=new Date,e=2===a.length?(a[0]*Math.random()+a[1]*Math.random())/10:(10*Math.random()+100*Math.random()+1e3*Math.random())/100,f[g]=parseInt(e*d.getMilliseconds()/10);f[g]>255;)f[g]-=255;return c(),f},c()};var d=function(a,d,e,f){var g,h;new c.RandomGenerator;if("function"!=typeof a||"function"!=typeof d)throw"Success and Error callbacks are mandatory and must be functions!";var i=function(a){"function"==typeof e&&e(a,g.getLength())},j=function(a){g.saveToDisk(a)};this.encryptFile=function(a,c){var e=[];g=new b(a),h=new sEncrypt.Encryptor({saveBlock:g.store,readBlock:g.readChunk,progressHandler:i,finishHandler:j,errorHandler:d}),h.encrypt(c,e)},this.decryptFile=function(a,c){g=new b(a),h=new sEncrypt.Encryptor({saveBlock:g.store,readBlock:g.readChunk,progressHandler:i,finishHandler:j,errorHandler:d}),h.decrypt(c)}};"undefined"!=typeof exports?exports.smf=d:"function"==typeof define&&define.amd?define("smf",[],function(){return d}):a.smf=d}(this);